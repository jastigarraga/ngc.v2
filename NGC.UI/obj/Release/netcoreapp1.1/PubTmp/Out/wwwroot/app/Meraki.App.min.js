function to_error_string(n){return typeof n!="undefined"?n.message||n.statusText||n:"Error desconocido"}angular.module("Meraki.UI",["ngAnimate","ngMaterial"]).service("authInterceptor",["$q","$rootScope",function(n,t){var i=this;i.responseError=function(i){return i.status==401?window.location=Routes.Login:i.status==404&&t.$broadcast("meraki-alert",{title:"Error 404!!",message:"No se ha podido encontrar la dirección "+i.config.url}),n.reject(i)}}]).config(["$httpProvider",function(n){n.interceptors.push("authInterceptor")}]);angular.module("MerakiApp",["Meraki.UI","ngRoute"]).config(function(n){n.formatDate=function(n){if(typeof n=="undefined")return"";var i=n.getDate(),t=n.getMonth()+1,r=n.getFullYear();return t=t<10?"0"+t:""+t,i+"/"+t+"/"+r}}).controller("MerakiMainController",["$scope","$mdSidenav","$mdDialog",function(n,t,i){n.$on("meraki-alert",function(n,t){i.show(i.alert().title(t.title).textContent(t.message).ariaLabel(t.aria||"error").ok("Aceptar"))});n.openSidenav=function(){t("left").toggle()};n.loginFormSubmit=function(t){n.loginForm.$valid||(t.preventDefault(),t.stopPropagation(),n.loginForm.$setSubmitted(!0))};n.showDialog=function(n,t,r){i.show(i.alert().title(n).textContent(t).ariaLabel(r||"error").ok("Aceptar"))}}]).controller("MerakiCustomerController",function(n){n.grid={cols:[{title:"Email",name:"email",width:"120px",templateUrl:Templates.ViewBase},{title:"Fecha",name:"date",templateUrl:Templates.ViewDate},{title:"Envío",name:"lastSent",templateUrl:Templates.ViewDate},{title:"Nombre",name:"name",templateUrl:Templates.ViewBase+"?model=Name"},{title:"Primer apellido",name:"surname1",templateUrl:Templates.ViewBase},{title:"Segundo apellido",name:"surname2",templateUrl:Templates.ViewBase}],templateUrl:template("MerakiCustomerEditorTemplate"),transport:{read:{url:ApiRoutes.Customers},update:{url:ApiRoutes.Customers,method:"POST"},insert:{url:ApiRoutes.Customers,method:"PUT"},"delete":{url:ApiRoutes.Customers,method:"DELETE"}},pageSizes:[5,10,20,50]}}).controller("merakiConfigController",["$scope","$http","$mdDialog",function(n,t,i){function r(n){i.show({template:"<md-dialog aria-label='Introduzca email'>  <md-dialog-header>    <p>Introduzca la dirección de destino<\/p>  <\/md-dialog-header>  <md-dialog-content>    <form name='from'>      <md-input-container>        <label>Destino<\/label>        <input type='email' name='email' ng-model='to'/>      <\/md-input-container>    <\/form>  <\/md-dialog-content>  <md-dialog-actions>    <md-button ng-click='close()'>Cancelar<\/md-button>    <md-button ng-click='accept()'>Aceptar<\/md-button>",controller:function(t,i){t.close=function(){i.hide()};t.accept=function(){i.hide();n(t.to)}}})}n.testEmailConfig=function(){r(function(i){var r=angular.copy(n.Email);r.To=i;t({url:ApiRoutes.EmailConfig,method:"POST",data:r}).then(function(){n.loading=!1},function(){n.loading=!1})})};n.saveEmailConfig=function(){n.emailForm.$valid?(n.loading=!0,t({url:ApiRoutes.EmailConfig,method:"PUT",data:n.Email}).then(function(){n.loading=!1},function(){n.loading=!1})):n.emailForm.$setSubmitted(!0)};n.loadMailConfig=function(){n.loading=!0;t({url:ApiRoutes.EmailConfig}).then(function(t){n.Email=t.data;n.loading=!1},function(){n.loading=!1})};n.loadMailConfig()}]).controller("MerakiTemplateEditorController",["$scope","$mdDialog","$http",function(n,t,i){function r(){n.loading=!0;i({url:ApiRoutes.Templates}).then(function(t){n.loading=!1;n.templates=t.data},function(i){n.loading=!1;var r=t.alert({title:"Error",textContent:to_error_string(i),ok:"Aceptar"});t.show(r).finally(function(){r=undefined})})}n.templates=[];n.new=function(){n.template={name:"Plantilla nueva"};n.templates.push(n.template)};n.select=function(t){n.template=t};r()}]);angular.module("Meraki.UI");